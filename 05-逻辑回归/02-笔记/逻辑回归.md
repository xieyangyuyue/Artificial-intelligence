# é€»è¾‘å›å½’

## é€»è¾‘å›å½’ç®€ä»‹

**å­¦ä¹ ç›®æ ‡ï¼š**

1.çŸ¥é“é€»è¾‘å›å½’çš„åº”ç”¨åœºæ™¯

2.å¤ä¹ é€»è¾‘å›å½’åº”ç”¨åˆ°çš„æ•°å­¦çŸ¥è¯†

### ã€äº†è§£ã€‘åº”ç”¨åœºæ™¯

![image-20230904115156371](images/image-20230904115156371.png)

é€»è¾‘å›å½’æ˜¯è§£å†³äºŒåˆ†ç±»é—®é¢˜çš„åˆ©å™¨

### ã€ç†Ÿæ‚‰ã€‘æ•°å­¦çŸ¥è¯†

#### ã€çŸ¥é“ã€‘sigmoidå‡½æ•°

![image-20230913152535607](images/image-20230913152535607.png)

![image-20230904144434180](images/image-20230904144434180.png)

![image-20230904144454316](images/image-20230904144454316.png)



#### ã€ç†è§£ã€‘æ¦‚ç‡

![image-20230904144658969](images/image-20230904144658969.png)





#### ã€ç†è§£ã€‘æå¤§ä¼¼ç„¶ä¼°è®¡

æ ¸å¿ƒæ€æƒ³ï¼š

è®¾æ¨¡å‹ä¸­å«æœ‰å¾…ä¼°å‚æ•°wï¼Œå¯ä»¥å–å¾ˆå¤šå€¼ã€‚å·²ç»çŸ¥é“äº†æ ·æœ¬è§‚æµ‹å€¼ï¼Œä»wçš„ä¸€åˆ‡å¯èƒ½å€¼ä¸­ï¼ˆé€‰å‡ºä¸€ä¸ªä½¿è¯¥è§‚å¯Ÿå€¼å‡ºç°çš„æ¦‚ç‡ä¸ºæœ€å¤§çš„å€¼ï¼Œä½œä¸ºwå‚æ•°çš„ä¼°è®¡å€¼ï¼Œè¿™å°±æ˜¯æå¤§ä¼¼ç„¶ä¼°è®¡ã€‚ï¼ˆé¡¾åæ€ä¹‰ï¼šå°±æ˜¯çœ‹ä¸Šå»é‚£ä¸ªæ˜¯æœ€å¤§å¯èƒ½çš„æ„æ€ï¼‰

ä¸¾ä¸ªä¾‹å­ï¼š

å‡è®¾æœ‰ä¸€æšä¸å‡åŒ€çš„ç¡¬å¸ï¼Œå‡ºç°æ­£é¢çš„æ¦‚ç‡å’Œåé¢çš„æ¦‚ç‡æ˜¯ä¸åŒçš„ã€‚å‡å®šå‡ºç°æ­£é¢çš„æ¦‚ç‡ä¸ºğœƒï¼Œ æŠ›äº†6æ¬¡å¾—åˆ°å¦‚ä¸‹ç°è±¡ D = {æ­£é¢ï¼Œåé¢ï¼Œåé¢ï¼Œæ­£é¢ï¼Œæ­£é¢ï¼Œæ­£é¢}ã€‚æ¯æ¬¡æŠ•æ·äº‹ä»¶éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ åˆ™æ ¹æ®äº§ç”Ÿçš„ç°è±¡Dï¼Œæ¥ä¼°è®¡å‚æ•°ğœƒæ˜¯å¤šå°‘?

```
P(D|ğœƒ) = P {æ­£é¢ï¼Œåé¢ï¼Œåé¢ï¼Œæ­£é¢ï¼Œæ­£é¢ï¼Œæ­£é¢}
 = P(æ­£é¢|ğœƒ) P(æ­£é¢|ğœƒ) P(æ­£é¢|ğœƒ) P(æ­£é¢|ğœƒ) P(æ­£é¢|ğœƒ) P(æ­£é¢|ğœƒ)

=ğœƒ *(1-ğœƒ)*(1-ğœƒ)ğœƒ*ğœƒ*ğœƒ = ğœƒ4(1 âˆ’ ğœƒ)
```

é—®é¢˜è½¬åŒ–ä¸º:æ±‚æ­¤å‡½æ•°çš„æå¤§å€¼æ—¶ï¼Œä¼°è®¡ğœƒä¸ºå¤šå°‘

![image-20230904145453737](images/image-20230904145453737.png)



#### ã€çŸ¥é“ã€‘å¯¹æ•°å‡½æ•°



![image-20230904145530932](images/image-20230904145530932.png)







## é€»è¾‘å›å½’åŸç†

**å­¦ä¹ ç›®æ ‡**
1.ç†è§£é€»è¾‘å›å½’ç®—æ³•çš„åŸç†

2.çŸ¥é“é€»è¾‘å›å½’çš„æŸå¤±å‡½æ•°

### ã€ç†è§£ã€‘åŸç†

é€»è¾‘å›å½’æ¦‚å¿µ Logistic Regression

â€¢ ä¸€ç§åˆ†ç±»æ¨¡å‹ï¼ŒæŠŠçº¿æ€§å›å½’çš„è¾“å‡ºï¼Œä½œä¸ºé€»è¾‘å›å½’çš„è¾“å…¥ã€‚ 

â€¢ è¾“å‡ºæ˜¯(0, 1)ä¹‹é—´çš„å€¼

â€¢ åŸºæœ¬æ€æƒ³

1. åˆ©ç”¨çº¿æ€§æ¨¡å‹ f(x) = wx + b æ ¹æ®ç‰¹å¾çš„é‡è¦æ€§è®¡ç®—å‡ºä¸€ä¸ªå€¼
2. å†ä½¿ç”¨ sigmoid å‡½æ•°å°† f(x) çš„è¾“å‡ºå€¼æ˜ å°„ä¸ºæ¦‚ç‡å€¼
   1. è®¾ç½®é˜ˆå€¼(eg:0.5)ï¼Œè¾“å‡ºæ¦‚ç‡å€¼å¤§äº 0.5ï¼Œåˆ™å°†æœªçŸ¥æ ·æœ¬è¾“å‡ºä¸º 1 ç±»
   2. å¦åˆ™è¾“å‡ºä¸º 0 ç±»

3.é€»è¾‘å›å½’çš„å‡è®¾å‡½æ•°
 h(w) = sigmoid(wx + b )

çº¿æ€§å›å½’çš„è¾“å‡ºï¼Œä½œä¸ºé€»è¾‘å›å½’çš„è¾“å…¥

â€‹      

**åœ¨é€»è¾‘å›å½’ä¸­ï¼Œå½“é¢„æµ‹ç»“æœä¸å¯¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¯¥æ€ä¹ˆè¡¡é‡å…¶æŸå¤±å‘¢ï¼Ÿ**

æˆ‘ä»¬æ¥çœ‹ä¸‹å›¾(ä¸‹å›¾ä¸­ï¼Œè®¾ç½®é˜ˆå€¼ä¸º0.6)ï¼Œ

![image-20220121161828121](images/image-20220121161828121.png) 

é‚£ä¹ˆå¦‚ä½•å»è¡¡é‡é€»è¾‘å›å½’çš„é¢„æµ‹ç»“æœä¸çœŸå®ç»“æœçš„å·®å¼‚ï¼Ÿ



### ã€çŸ¥é“ã€‘æŸå¤±å‡½æ•°

![image-20230904151300483](image-20230904151300483.png)



![image-20230904151334262](images/image-20230904151334262.png)



![image-20230904151343779](images/image-20230904151343779.png)





## é€»è¾‘å›å½’API

**å­¦ä¹ ç›®æ ‡ï¼š**

1.çŸ¥é“é€»è¾‘å›å½’çš„API

2.åŠ¨æ‰‹å®ç°ç™Œç—‡åˆ†ç±»æ¡ˆä¾‹

### ã€çŸ¥é“ã€‘APIä»‹ç»

```python
sklearn.linear_model.LogisticRegression(solver='liblinear', penalty=â€˜l2â€™, C = 1.0)
```

**solver** **æŸå¤±å‡½æ•°ä¼˜åŒ–æ–¹æ³•**:

è®­ç»ƒé€Ÿåº¦:liblinear å¯¹å°æ•°æ®é›†åœºæ™¯è®­ç»ƒé€Ÿåº¦æ›´å¿«ï¼Œsag å’Œ saga å¯¹å¤§æ•°æ®é›†æ›´å¿«ä¸€äº›ã€‚ 2 æ­£åˆ™åŒ–:

1. newton-cgã€lbfgsã€sagã€saga æ”¯æŒ L2 æ­£åˆ™åŒ–æˆ–è€…æ²¡æœ‰æ­£åˆ™åŒ–
2. 2liblinear å’Œ saga æ”¯æŒ L1 æ­£åˆ™åŒ–

**penalty**:æ­£åˆ™åŒ–çš„ç§ç±»ï¼Œl1 æˆ–è€… l2

**C**:æ­£åˆ™åŒ–åŠ›åº¦

é»˜è®¤å°†ç±»åˆ«æ•°é‡å°‘çš„å½“åšæ­£ä¾‹



### ã€å®è·µã€‘ç™Œç—‡åˆ†ç±»æ¡ˆä¾‹

- æ•°æ®ä»‹ç»

ï¼ˆ1ï¼‰699æ¡æ ·æœ¬ï¼Œå…±11åˆ—æ•°æ®ï¼Œç¬¬ä¸€åˆ—ç”¨è¯­æ£€ç´¢çš„idï¼Œå9åˆ—åˆ†åˆ«æ˜¯ä¸è‚¿ç˜¤ç›¸å…³çš„åŒ»å­¦ç‰¹å¾ï¼Œ

â€‹     æœ€åä¸€åˆ—è¡¨ç¤ºè‚¿ç˜¤ç±»å‹çš„æ•°å€¼ã€‚

ï¼ˆ2ï¼‰åŒ…å«16ä¸ªç¼ºå¤±å€¼ï¼Œç”¨â€?â€æ ‡å‡ºã€‚

ï¼ˆ3ï¼‰2è¡¨ç¤ºè‰¯æ€§ï¼Œ4è¡¨ç¤ºæ¶æ€§

> æ•°æ®æè¿°
>
> ï¼ˆ1ï¼‰699æ¡æ ·æœ¬ï¼Œå…±11åˆ—æ•°æ®ï¼Œç¬¬ä¸€åˆ—ç”¨è¯­æ£€ç´¢çš„idï¼Œå9åˆ—åˆ†åˆ«æ˜¯ä¸è‚¿ç˜¤
>
> ç›¸å…³çš„åŒ»å­¦ç‰¹å¾ï¼Œæœ€åä¸€åˆ—è¡¨ç¤ºè‚¿ç˜¤ç±»å‹çš„æ•°å€¼ã€‚
>
> ï¼ˆ2ï¼‰åŒ…å«16ä¸ªç¼ºå¤±å€¼ï¼Œç”¨â€?â€æ ‡å‡ºã€‚

â€‹	

- æ¡ˆä¾‹åˆ†æ

```
1.è·å–æ•°æ®
2.åŸºæœ¬æ•°æ®å¤„ç†
2.1 ç¼ºå¤±å€¼å¤„ç†
2.2 ç¡®å®šç‰¹å¾å€¼,ç›®æ ‡å€¼
2.3 åˆ†å‰²æ•°æ®
3.ç‰¹å¾å·¥ç¨‹(æ ‡å‡†åŒ–)
4.æœºå™¨å­¦ä¹ (é€»è¾‘å›å½’)
5.æ¨¡å‹è¯„ä¼°
```

- ä»£ç å®ç°

```python
import pandas as pd
import numpy as np
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler


def dm01_LogisticRegression():
    # 1. è·å–æ•°æ®.
    data = pd.read_csv('data/breast-cancer-wisconsin.csv')
    data.info()

    # 2. æ•°æ®é¢„å¤„ç†.
    # data = data.replace(to_replace='?', value=np.NAN)
    data = data.replace('?', np.NaN)
    data = data.dropna()
    data.info()

    # 3. ç¡®å®šç‰¹å¾å€¼å’Œç›®æ ‡å€¼.
    x = data.iloc[:, 1:-1]
    y = data.Class
    print(f'x.head(): {x.head()}')
    print(f'y.head(): {y.head()}')

    # 3. åˆ†å‰²æ•°æ®.
    x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.2, random_state=21)
    # 4. ç‰¹å¾å¤„ç†.
    transfer = StandardScaler()
    x_train = transfer.fit_transform(x_train)
    x_test = transfer.transform(x_test)
    # 5. æ¨¡å‹è®­ç»ƒ.
    estimator = LogisticRegression()
    estimator.fit(x_train, y_train)
    # 6. æ¨¡å‹é¢„æµ‹
    y_predict = estimator.predict(x_test)
    print(f'é¢„æµ‹å€¼: {y_predict}')

    # 7. æ¨¡å‹è¯„ä¼°
    print(f'å‡†ç¡®ç‡: {estimator.score(x_test, y_test)}')
    print(f'å‡†ç¡®ç‡: {accuracy_score(y_test, y_predict)}')

if __name__ == '__main__':
    dm01_LogisticRegression()

```



## åˆ†ç±»è¯„ä¼°æ–¹æ³•

**å­¦ä¹ ç›®æ ‡ï¼š**

1.ç†è§£æ··æ·†çŸ©é˜µçš„æ„å»ºæ–¹æ³•

2.æŒæ¡ç²¾ç¡®ç‡ï¼Œå¬å›ç‡å’ŒF1scoreçš„è®¡ç®—æ–¹æ³•

3.çŸ¥é“ROCæ›²çº¿å’ŒAUCæŒ‡æ ‡

### ã€ç†è§£ã€‘æ··æ·†çŸ©é˜µ

![image-20230904162952115](images/image-20230904162952115.png)

æ··æ·†çŸ©é˜µä½œç”¨åœ¨æµ‹è¯•é›†æ ·æœ¬é›†ä¸­ï¼š

1. çœŸå®å€¼æ˜¯ **æ­£ä¾‹** çš„æ ·æœ¬ä¸­ï¼Œè¢«åˆ†ç±»ä¸º **æ­£ä¾‹** çš„æ ·æœ¬æ•°é‡æœ‰å¤šå°‘ï¼Œè¿™éƒ¨åˆ†æ ·æœ¬å«åšçœŸæ­£ä¾‹ï¼ˆTPï¼ŒTrue Positiveï¼‰
2. çœŸå®å€¼æ˜¯ **æ­£ä¾‹** çš„æ ·æœ¬ä¸­ï¼Œè¢«åˆ†ç±»ä¸º **å‡ä¾‹** çš„æ ·æœ¬æ•°é‡æœ‰å¤šå°‘ï¼Œè¿™éƒ¨åˆ†æ ·æœ¬å«åšä¼ªåä¾‹ï¼ˆFNï¼ŒFalse Negativeï¼‰
3. çœŸå®å€¼æ˜¯ **å‡ä¾‹** çš„æ ·æœ¬ä¸­ï¼Œè¢«åˆ†ç±»ä¸º **æ­£ä¾‹** çš„æ ·æœ¬æ•°é‡æœ‰å¤šå°‘ï¼Œè¿™éƒ¨åˆ†æ ·æœ¬å«åšä¼ªæ­£ä¾‹ï¼ˆFPï¼ŒFalse Positiveï¼‰
4. çœŸå®å€¼æ˜¯ **å‡ä¾‹** çš„æ ·æœ¬ä¸­ï¼Œè¢«åˆ†ç±»ä¸º **å‡ä¾‹** çš„æ ·æœ¬æ•°é‡æœ‰å¤šå°‘ï¼Œè¿™éƒ¨åˆ†æ ·æœ¬å«åšçœŸåä¾‹ï¼ˆTNï¼ŒTrue Negativeï¼‰



> True Positive ï¼šè¡¨ç¤ºæ ·æœ¬çœŸå®çš„ç±»åˆ«
> Positive ï¼šè¡¨ç¤ºæ ·æœ¬è¢«é¢„æµ‹ä¸ºçš„ç±»åˆ«


**ä¾‹å­ï¼š**

æ ·æœ¬é›†ä¸­æœ‰ 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œæˆ‘ä»¬å‡è®¾æ¶æ€§è‚¿ç˜¤ä¸ºæ­£ä¾‹ï¼Œåˆ™ï¼š

**æ¨¡å‹ Aï¼š** é¢„æµ‹å¯¹äº† 3 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š3 
2. ä¼ªåä¾‹ FN ä¸ºï¼š3
3. ä¼ªæ­£ä¾‹ FP ä¸ºï¼š0
4. çœŸåä¾‹ TNï¼š4

**æ¨¡å‹ Bï¼š** é¢„æµ‹å¯¹äº† 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ1ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š6
2. ä¼ªåä¾‹ FN ä¸ºï¼š0
3. ä¼ªæ­£ä¾‹ FP ä¸ºï¼š3
4. çœŸåä¾‹ TNï¼š1



æˆ‘ä»¬ä¼šå‘ç°ï¼šTP+FN+FP+TN = æ€»æ ·æœ¬æ•°é‡

```python
from sklearn.metrics import confusion_matrix, precision_score, recall_score, f1_score
import pandas as pd


def dm01_æ··æ·†çŸ©é˜µå››ä¸ªæŒ‡æ ‡():
    # 1. å®šä¹‰æ ·æœ¬é›†, 6ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬, 4ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬
    y_true = ['æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§']

    # 2. å®šä¹‰æ ‡ç­¾
    labels = ['æ¶æ€§', 'è‰¯æ€§']

    # 3. æ¨¡å‹A => é¢„æµ‹å¯¹äº† 3ä¸ªæ¶æ€§, 4ä¸ªè‰¯æ€§.
    y_pred_A = ['æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§', 'è‰¯æ€§']
    result = confusion_matrix(y_true, y_pred_A)
    print(pd.DataFrame(result, index=labels, columns=labels))

    # 4. æ¨¡å‹B => é¢„æµ‹å¯¹äº†6ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬, 1ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬.
    y_pred_B = ['æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'æ¶æ€§', 'è‰¯æ€§']
    result = confusion_matrix(y_true, y_pred_B)
    print(pd.DataFrame(result, index=labels, columns=labels))


    # 5. è®¡ç®—ç²¾ç¡®ç‡ (precision)
    print(f'æ¨¡å‹Aç²¾ç¡®ç‡: {precision_score(y_true, y_pred_A, pos_label="æ¶æ€§")}')
    print(f'æ¨¡å‹Bç²¾ç¡®ç‡: {precision_score(y_true, y_pred_B, pos_label="æ¶æ€§")}')

    # 6. è®¡ç®—å¬å›ç‡ (recall)
    print(f'æ¨¡å‹Aå¬å›ç‡: {recall_score(y_true, y_pred_A, pos_label="æ¶æ€§")}')
    print(f'æ¨¡å‹Bå¬å›ç‡: {recall_score(y_true, y_pred_B, pos_label="æ¶æ€§")}')

    # 7. è®¡ç®—F1å€¼
    print(f'æ¨¡å‹A F1å€¼: {f1_score(y_true, y_pred_A, pos_label="æ¶æ€§")}')
    print(f'æ¨¡å‹B F1å€¼: {f1_score(y_true, y_pred_B, pos_label="æ¶æ€§")}')


if __name__ == '__main__':
    dm01_æ··æ·†çŸ©é˜µå››ä¸ªæŒ‡æ ‡()
```





### ã€æŒæ¡ã€‘Precisionï¼ˆç²¾ç¡®ç‡ï¼‰


ç²¾ç¡®ç‡ä¹Ÿå«åšæŸ¥å‡†ç‡ï¼ŒæŒ‡çš„æ˜¯å¯¹æ­£ä¾‹æ ·æœ¬çš„é¢„æµ‹å‡†ç¡®ç‡ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬æŠŠæ¶æ€§è‚¿ç˜¤å½“åšæ­£ä¾‹æ ·æœ¬ï¼Œåˆ™æˆ‘ä»¬å°±éœ€è¦çŸ¥é“æ¨¡å‹å¯¹æ¶æ€§è‚¿ç˜¤çš„é¢„æµ‹å‡†ç¡®ç‡ã€‚


<img src="images/05.png" alt="image-20210709223432330" style="zoom:50%;" />



**ä¾‹å­ï¼š**

æ ·æœ¬é›†ä¸­æœ‰ 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œæˆ‘ä»¬å‡è®¾æ¶æ€§è‚¿ç˜¤ä¸ºæ­£ä¾‹ï¼Œåˆ™ï¼š

**æ¨¡å‹ Aï¼š** é¢„æµ‹å¯¹äº† 3 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š3 
2. ä¼ªåä¾‹ FN ä¸ºï¼š3
3. å‡æ­£ä¾‹ FP ä¸ºï¼š0
4. çœŸåä¾‹ TNï¼š4
5. **ç²¾å‡†ç‡ï¼š3/(3+0) = 100%**



**æ¨¡å‹ Bï¼š** é¢„æµ‹å¯¹äº† 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ1ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š6
2. ä¼ªåä¾‹ FN ä¸ºï¼š0
3. å‡æ­£ä¾‹ FP ä¸ºï¼š3
4. çœŸåä¾‹ TNï¼š1
5. **ç²¾å‡†ç‡ï¼š6/(6+3) = 67%**





### ã€æŒæ¡ã€‘Recallï¼ˆå¬å›ç‡ï¼‰


å¬å›ç‡ä¹Ÿå«åšæŸ¥å…¨ç‡ï¼ŒæŒ‡çš„æ˜¯é¢„æµ‹ä¸ºçœŸæ­£ä¾‹æ ·æœ¬å æ‰€æœ‰çœŸå®æ­£ä¾‹æ ·æœ¬çš„æ¯”é‡ã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬æŠŠæ¶æ€§è‚¿ç˜¤å½“åšæ­£ä¾‹æ ·æœ¬ï¼Œåˆ™æˆ‘ä»¬æƒ³çŸ¥é“æ¨¡å‹æ˜¯å¦èƒ½æŠŠæ‰€æœ‰çš„æ¶æ€§è‚¿ç˜¤æ‚£è€…éƒ½é¢„æµ‹å‡ºæ¥ã€‚


<img src="images/06.png" />


**ä¾‹å­ï¼š**

æ ·æœ¬é›†ä¸­æœ‰ 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œæˆ‘ä»¬å‡è®¾æ¶æ€§è‚¿ç˜¤ä¸ºæ­£ä¾‹ï¼Œåˆ™ï¼š

**æ¨¡å‹ Aï¼š** é¢„æµ‹å¯¹äº† 3 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š3 
2. ä¼ªåä¾‹ FN ä¸ºï¼š3
3. å‡æ­£ä¾‹ FP ä¸ºï¼š0
4. çœŸåä¾‹ TNï¼š4
5. **ç²¾å‡†ç‡ï¼š3/(3+0) = 100%**
6. **å¬å›ç‡ï¼š3/(3+3)=50%**

**æ¨¡å‹ Bï¼š** é¢„æµ‹å¯¹äº† 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ1ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š6
2. ä¼ªåä¾‹ FN ä¸ºï¼š0
3. å‡æ­£ä¾‹ FP ä¸ºï¼š3
4. çœŸåä¾‹ TNï¼š1
5. **ç²¾å‡†ç‡ï¼š6/(6+3) = 67%**
6. **å¬å›ç‡ï¼š6/(6+0)= 100%** 



###  ã€æŒæ¡ã€‘F1-score

å¦‚æœæˆ‘ä»¬å¯¹æ¨¡å‹çš„ç²¾åº¦ã€å¬å›ç‡éƒ½æœ‰è¦æ±‚ï¼Œå¸Œæœ›çŸ¥é“æ¨¡å‹åœ¨è¿™ä¸¤ä¸ªè¯„ä¼°æ–¹å‘çš„ç»¼åˆé¢„æµ‹èƒ½åŠ›å¦‚ä½•ï¼Ÿåˆ™å¯ä»¥ä½¿ç”¨ F1-score æŒ‡æ ‡ã€‚

<img src="images/07.png" />

æ ·æœ¬é›†ä¸­æœ‰ 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œæˆ‘ä»¬å‡è®¾æ¶æ€§è‚¿ç˜¤ä¸ºæ­£ä¾‹ï¼Œåˆ™ï¼š

**æ¨¡å‹ Aï¼š** é¢„æµ‹å¯¹äº† 3 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ4 ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬



1. çœŸæ­£ä¾‹ TP ä¸ºï¼š3 
2. ä¼ªåä¾‹ FN ä¸ºï¼š3
3. å‡æ­£ä¾‹ FP ä¸ºï¼š0
4. çœŸåä¾‹ TNï¼š4
5. **ç²¾å‡†ç‡ï¼š3/(3+0) = 100%**
6. **å¬å›ç‡ï¼š3/(3+3)=50%**
7. **F1-scoreï¼š(2\*3)/(2\*3+3+0)=67%**

**æ¨¡å‹ Bï¼š** é¢„æµ‹å¯¹äº† 6 ä¸ªæ¶æ€§è‚¿ç˜¤æ ·æœ¬ï¼Œ1ä¸ªè‰¯æ€§è‚¿ç˜¤æ ·æœ¬

1. çœŸæ­£ä¾‹ TP ä¸ºï¼š6
2. ä¼ªåä¾‹ FN ä¸ºï¼š0
3. å‡æ­£ä¾‹ FP ä¸ºï¼š3
4. çœŸåä¾‹ TNï¼š1
5. **ç²¾å‡†ç‡ï¼š6/(6+3) = 67%**
6. **å¬å›ç‡ï¼š6/(6+0)= 100%** 
7. **F1-scoreï¼š(2\*6)/(2\*6+0+3)=80%**


###  ã€çŸ¥é“ã€‘ROCæ›²çº¿å’ŒAUCæŒ‡æ ‡

####  ROC æ›²çº¿

ROC æ›²çº¿ï¼šæˆ‘ä»¬åˆ†åˆ«è€ƒè™‘æ­£è´Ÿæ ·æœ¬çš„æƒ…å†µï¼š

1. æ­£æ ·æœ¬ä¸­è¢«é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ï¼Œå³ï¼šTPR ï¼ˆTrue Positive Rateï¼‰
2. è´Ÿæ ·æœ¬ä¸­è¢«é¢„æµ‹ä¸ºæ­£æ ·æœ¬çš„æ¦‚ç‡ï¼Œå³ï¼šFPR ï¼ˆFalse Positive Rateï¼‰

![image-20230904182146483](images/image-20230904182146483.png)

ROC æ›²çº¿å›¾åƒä¸­ï¼Œ4 ä¸ªç‰¹æ®Šç‚¹çš„å«ä¹‰ï¼š



1. (0, 0) è¡¨ç¤ºæ‰€æœ‰çš„æ­£æ ·æœ¬éƒ½é¢„æµ‹ä¸ºé”™è¯¯ï¼Œæ‰€æœ‰çš„è´Ÿæ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®
2. (1, 0) è¡¨ç¤ºæ‰€æœ‰çš„æ­£æ ·æœ¬éƒ½é¢„æµ‹é”™è¯¯ï¼Œæ‰€æœ‰çš„è´Ÿæ ·æœ¬éƒ½é¢„æµ‹é”™è¯¯
3. (1, 1) è¡¨ç¤ºæ‰€æœ‰çš„æ­£æ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®ï¼Œæ‰€æœ‰çš„è´Ÿæ ·æœ¬éƒ½é¢„æµ‹é”™è¯¯
4. (0, 1) è¡¨ç¤ºæ‰€æœ‰çš„æ­£æ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®ï¼Œæ‰€æœ‰çš„è´Ÿæ ·æœ¬éƒ½é¢„æµ‹æ­£ç¡®



#### ç»˜åˆ¶ ROC æ›²çº¿

å‡è®¾ï¼šåœ¨ç½‘é¡µæŸä¸ªä½ç½®æœ‰ä¸€ä¸ªå¹¿å‘Šå›¾ç‰‡æˆ–è€…æ–‡å­—ï¼Œè¯¥å¹¿å‘Šå…±è¢«å±•ç¤ºäº† 6 æ¬¡ï¼Œæœ‰ 2 æ¬¡è¢«æµè§ˆè€…ç‚¹å‡»äº†ã€‚æ¯æ¬¡ç‚¹å‡»çš„æ¦‚ç‡å¦‚ä¸‹ï¼š



| æ ·æœ¬ | æ˜¯å¦è¢«ç‚¹å‡» | é¢„æµ‹ç‚¹å‡»æ¦‚ç‡ |
| :--: | :--------: | :----------: |
|  1   |     1      |     0.9      |
|  2   |     0      |     0.7      |
|  3   |     1      |     0.8      |
|  4   |     0      |     0.6      |
|  5   |     0      |     0.5      |
|  6   |     0      |     0.4      |

æ ¹æ®é¢„æµ‹ç‚¹å‡»æ¦‚ç‡æ’åºä¹‹åï¼š

| æ ·æœ¬ | æ˜¯å¦è¢«ç‚¹å‡» | é¢„æµ‹ç‚¹å‡»æ¦‚ç‡ |
| :--: | :--------: | :----------: |
|  1   |     1      |     0.9      |
|  3   |     1      |     0.8      |
|  2   |     0      |     0.7      |
|  4   |     0      |     0.6      |
|  5   |     0      |     0.5      |
|  6   |     0      |     0.4      |

ç»˜åˆ¶ ROC æ›²çº¿ï¼š

**é˜ˆå€¼ï¼š0.9**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·çš„æ ·æœ¬ä¸­ 3 å·æ ·æœ¬è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ TPR = 1/2 = 0.5
2. åŸæœ¬ä¸ºè´Ÿä¾‹çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬æ²¡æœ‰ä¸€ä¸ªè¢«åˆ†ä¸ºæ­£ä¾‹ï¼Œåˆ™ FPR = 0

**é˜ˆå€¼ï¼š0.8**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·æ ·æœ¬è¢«åˆ†ç±»æ­£ç¡®ï¼Œåˆ™ TPR = 2/2 = 1
2. åŸæœ¬ä¸ºè´Ÿä¾‹çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬æ²¡æœ‰ä¸€ä¸ªè¢«åˆ†ä¸ºæ­£ä¾‹ï¼Œåˆ™ FPR = 0

**é˜ˆå€¼ï¼š0.7**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·æ ·æœ¬è¢«åˆ†ç±»æ­£ç¡®ï¼Œåˆ™ TPR = 2/2 = 1
2. åŸæœ¬ä¸ºè´Ÿç±»çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬ä¸­ 2 å·æ ·æœ¬è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ FPR = 1/4 = 0.25

**é˜ˆå€¼ï¼š0.6**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·æ ·æœ¬è¢«åˆ†ç±»æ­£ç¡®ï¼Œåˆ™ TPR = 2/2 = 1
2. åŸæœ¬ä¸ºè´Ÿç±»çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬ä¸­ 2ã€4 å·æ ·æœ¬è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ FPR = 2/4 = 0.5

**é˜ˆå€¼ï¼š0.5**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·æ ·æœ¬è¢«åˆ†ç±»æ­£ç¡®ï¼Œåˆ™ TPR = 2/2 = 1
2. åŸæœ¬ä¸ºè´Ÿç±»çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬ä¸­ 2ã€4ã€5 å·æ ·æœ¬è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ FPR = 3/4 = 0.75

**é˜ˆå€¼ 0.4**

1. åŸæœ¬ä¸ºæ­£ä¾‹çš„ 1ã€3 å·æ ·æœ¬è¢«åˆ†ç±»æ­£ç¡®ï¼Œåˆ™ TPR = 2/2 = 1
2. åŸæœ¬ä¸ºè´Ÿç±»çš„ 2ã€4ã€5ã€6 å·æ ·æœ¬å…¨éƒ¨è¢«åˆ†ç±»é”™è¯¯ï¼Œåˆ™ FPR = 4/4 = 1



(0, 0.5)ã€(0, 1)ã€(0.25, 1)ã€(0.5, 1)ã€(0.75, 1)ã€(1, 1)



ç”± TPR å’Œ FPR æ„æˆçš„ ROC å›¾åƒä¸ºï¼š



![image-20230914105309023](images/image-20230914105309023.png)




#### AUC å€¼



1. æˆ‘ä»¬å‘ç°ï¼šå›¾åƒè¶Šé è¿‘ (0,1) ç‚¹åˆ™æ¨¡å‹å¯¹æ­£è´Ÿæ ·æœ¬çš„è¾¨åˆ«èƒ½åŠ›å°±è¶Šå¼º
2. æˆ‘ä»¬å‘ç°ï¼šå›¾åƒè¶Šé è¿‘ (0, 1) ç‚¹åˆ™ ROC æ›²çº¿ä¸‹é¢çš„é¢ç§¯å°±ä¼šè¶Šå¤§
3. AUC æ˜¯ ROC æ›²çº¿ä¸‹é¢çš„é¢ç§¯ï¼Œè¯¥å€¼è¶Šå¤§ï¼Œåˆ™æ¨¡å‹çš„è¾¨åˆ«èƒ½åŠ›å°±è¶Šå¼º
4. AUC  èŒƒå›´åœ¨ [0, 1] ä¹‹é—´
5. å½“ AUC= 1 æ—¶ï¼Œè¯¥æ¨¡å‹è¢«è®¤ä¸ºæ˜¯å®Œç¾çš„åˆ†ç±»å™¨ï¼Œä½†æ˜¯å‡ ä¹ä¸å­˜åœ¨å®Œç¾åˆ†ç±»å™¨

> AUC å€¼ä¸»è¦è¯„ä¼°æ¨¡å‹å¯¹æ­£ä¾‹æ ·æœ¬ã€è´Ÿä¾‹æ ·æœ¬çš„è¾¨åˆ«èƒ½åŠ›.



####  **åˆ†ç±»è¯„ä¼°æŠ¥å‘Šapi**

```python
sklearn.metrics.classification_report(y_true, y_pred, labels=[], target_names=None )
  '''
  y_trueï¼šçœŸå®ç›®æ ‡å€¼
  y_predï¼šä¼°è®¡å™¨é¢„æµ‹ç›®æ ‡å€¼
  labels:æŒ‡å®šç±»åˆ«å¯¹åº”çš„æ•°å­—
  target_namesï¼šç›®æ ‡ç±»åˆ«åç§°
  returnï¼šæ¯ä¸ªç±»åˆ«ç²¾ç¡®ç‡ä¸å¬å›ç‡
  '''
```



####  **AUCè®¡ç®—API**

```
from sklearn.metrics import roc_auc_score
  sklearn.metrics.roc_auc_score(y_true, y_score)
    è®¡ç®—ROCæ›²çº¿é¢ç§¯ï¼Œå³AUCå€¼
    y_trueï¼šæ¯ä¸ªæ ·æœ¬çš„çœŸå®ç±»åˆ«ï¼Œå¿…é¡»ä¸º0(åä¾‹),1(æ­£ä¾‹)æ ‡è®°
    y_scoreï¼šé¢„æµ‹å¾—åˆ†ï¼Œå¯ä»¥æ˜¯æ­£ä¾‹çš„ä¼°è®¡æ¦‚ç‡ã€ç½®ä¿¡å€¼æˆ–è€…åˆ†ç±»å™¨æ–¹æ³•çš„è¿”å›å€¼
```





## ã€å®è·µã€‘ç”µä¿¡å®¢æˆ·æµå¤±é¢„æµ‹

**å­¦ä¹ ç›®æ ‡ï¼š**

1.äº†è§£æ¡ˆä¾‹çš„èƒŒæ™¯ä¿¡æ¯

2.çŸ¥é“æ¡ˆä¾‹çš„å¤„ç†æµç¨‹

3.åŠ¨æ‰‹å®ç°ç”µä¿¡å®¢æˆ·æµå¤±æ¡ˆä¾‹çš„ä»£ç 




### æ•°æ®é›†ä»‹ç»

- æµå¤±ç”¨æˆ·æŒ‡çš„ä½¿ç”¨è¿‡äº§å“å› ä¸ºæŸäº›åŸå› ä¸å†ä½¿ç”¨è¯¥äº§å“ã€‚éšç€äº§å“çš„æ›´æ–°è¿­ä»£ï¼Œéƒ½ä¼šå­˜åœ¨ä¸€å®šçš„æµå¤±æƒ…å†µï¼Œè¿™æ—¶æ­£å¸¸ç°è±¡ã€‚æµå¤±ç”¨æˆ·çš„æ¯”ä¾‹å’Œå˜åŒ–è¶‹åŠ¿èƒ½å¤Ÿåæ˜ è¯¥äº§å“å½“å‰æ˜¯å¦å­˜åœ¨é—®é¢˜ä»¥åŠæœªæ¥çš„å‘å±•è¶‹åŠ¿ã€‚
- å½“ç”¨æˆ·ç¾¤ä½“åºå¤§æ—¶ï¼Œæœ‰é™çš„äººåŠ›å’Œç²¾åŠ›ä¸èƒ½ä¸ºæ¯ä¸ªç”¨æˆ·éƒ½æŠ•å…¥å¤§é‡çš„æ—¶é—´ã€‚å¦‚æœå…¬å¸å¯ä»¥é¢„æµ‹å“ªäº›ç”¨æˆ·å¯èƒ½æå‰æµå¤±ï¼Œè¿™æ ·å°±èƒ½å°†ä¸»è¦ç²¾åŠ›èšç„¦äºè¿™äº›ç”¨æˆ·ï¼Œå®æ–½æœ‰æ•ˆçš„ç”¨æˆ·æŒ½ç•™ç­–ç•¥ï¼Œæé«˜ç”¨æˆ·ç²˜æ€§ã€‚
- æœ¬é¡¹ç›®æ—¨åœ¨é€šè¿‡åˆ†æç‰¹å¾å±æ€§ç¡®å®šç”¨æˆ·æµå¤±çš„åŸå› ï¼Œä»¥åŠå“ªäº›å› ç´ å¯èƒ½å¯¼è‡´ç”¨æˆ·æµå¤±ã€‚å»ºç«‹é¢„æµ‹æ¨¡å‹æ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æµå¤±ï¼Œå¹¶æå‡ºç”¨æˆ·æµå¤±é¢„è­¦ç­–ç•¥ã€‚
- å…·ä½“æ•°æ®è¯´æ˜å¦‚ä¸‹ï¼šæ•°æ®é›†ä¸­æ€»è®¡7043æ¡æ•°æ®ï¼Œ21ä¸ªç‰¹å¾å­—æ®µï¼Œæœ€ç»ˆåˆ†ç±»ç‰¹å¾ä¸ºChurnï¼šç”¨æˆ·æ˜¯å¦æµå¤±ï¼Œå…·ä½“å†…å®¹å¦‚ä¸‹æ‰€ç¤ºï¼š
  customerIDï¼šç”¨æˆ·ID
  genderï¼šæ€§åˆ«
  SeniorCitizenï¼šæ˜¯å¦æ˜¯è€äºº
  Partnerï¼šæ˜¯å¦æœ‰ä¼´ä¾£
  Dependentsï¼šæ˜¯å¦æœ‰éœ€è¦æŠšå…»çš„å­©å­
  tenureï¼šä»»èŒ
  PhoneServiceï¼šæ˜¯å¦åŠç†ç”µè¯æœåŠ¡
  MultipleLinesï¼šæ˜¯å¦å¼€é€šäº†å¤šæ¡çº¿è·¯
  InternetServiceï¼šæ˜¯å¦å¼€é€šç½‘ç»œæœåŠ¡å’Œå¼€é€šçš„æœåŠ¡ç±»å‹ï¼ˆå…‰çº¤ã€ç”µè¯æ‹¨å·ï¼‰
  TechSupportï¼šæ˜¯å¦åŠç†æŠ€æœ¯æ”¯æŒæœåŠ¡
  OnlineBackupï¼šæ˜¯å¦åŠç†åœ¨çº¿å¤‡ä»½æœåŠ¡
  OnlineSecurityï¼šæ˜¯å¦åŠç†åœ¨çº¿å®‰å…¨æœåŠ¡
  DeviceProtectionï¼šæ˜¯å¦åŠç†è®¾å¤‡ä¿æŠ¤æœåŠ¡
  StreamingTVï¼šæ˜¯å¦åŠç†ç”µè§†æœåŠ¡
  StreamingMoviesï¼šæ˜¯å¦åŠç†ç”µå½±æœåŠ¡
  Contractï¼šç­¾è®¢åˆçº¦çš„æ—¶é•¿
  PaperlessBillingï¼šæ˜¯å¦ç”³è¯·äº†æ— çº¸åŒ–è´¦å•
  PaymentMethodï¼šä»˜æ¬¾æ–¹å¼ï¼ˆç”µå­æ”¯ç¥¨ã€é‚®å¯„æ”¯ç¥¨ã€é“¶è¡Œè‡ªåŠ¨è½¬è´¦ã€ä¿¡ç”¨å¡è‡ªåŠ¨è½¬è´¦ï¼‰
  MonthlyChargesï¼šæœˆæ¶ˆè´¹
  TotalChargesï¼šæ€»æ¶ˆè´¹
  Churnï¼šç”¨æˆ·æ˜¯å¦æµå¤±

### å¤„ç†æµç¨‹

1ã€æ•°æ®åŸºæœ¬å¤„ç†

 	æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯

â€‹	å¯¹ç±»åˆ«æ•°æ®æ•°æ®è¿›è¡Œone-hotå¤„ç†

â€‹	æŸ¥çœ‹æ ‡ç­¾åˆ†å¸ƒæƒ…å†µ

2ã€ç‰¹å¾ç­›é€‰

â€‹	åˆ†æå“ªäº›ç‰¹å¾å¯¹æ ‡ç­¾å€¼å½±å“å¤§

â€‹	åˆæ­¥ç­›é€‰å‡ºå¯¹æ ‡ç­¾å½±å“æ¯”è¾ƒå¤§çš„ç‰¹å¾ï¼Œå½¢æˆxã€y

3ã€æ¨¡å‹è®­ç»ƒ

â€‹	æ¨¡å‹è®­ç»ƒ

â€‹	äº¤å‰éªŒè¯ç½‘æ ¼æœç´¢ç­‰

4ã€æ¨¡å‹è¯„ä¼°

â€‹	ç²¾ç¡®ç‡

â€‹	Roc_AUCæŒ‡æ ‡è®¡ç®—

###  æ¡ˆä¾‹å®ç°

```python
import numpy as np
import pandas as pd
import seaborn as sns
import matplotlib.pyplot as plt
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.metrics import accuracy_score, roc_auc_score


# 1. å®šä¹‰å‡½æ•°, è¡¨ç¤º: æ•°æ®åŸºæœ¬å¤„ç†
def dm01_æ•°æ®åŸºæœ¬å¤„ç†():
    # 1. è¯»å–æ•°æ®, æŸ¥çœ‹æ•°æ®çš„åŸºæœ¬ä¿¡æ¯.
    churn_pd = pd.read_csv('data/churn.csv')
    # churn_pd.info()
    # print(f'churn_pd.describe(): {churn_pd.describe()}')
    # print(f'churn_pd: {churn_pd}')

    # 2. å¤„ç†ç±»åˆ«å‹çš„æ•°æ®, ç±»åˆ«å‹æ•°æ®åš one-hotç¼–ç (çƒ­ç¼–ç ).
    churn_pd = pd.get_dummies(churn_pd)
    churn_pd.info()
    # print(f'churn_pd: {churn_pd}')

    # 3. å»é™¤åˆ— Churn_No, gender_Male
    churn_pd.drop(['Churn_No', 'gender_Male'], axis=1, inplace=True)  # æŒ‰åˆ—åˆ é™¤
    print(f'churn_pd: {churn_pd}')

    # 4. åˆ—æ ‡ç­¾é‡å‘½å, æ‰“å°åˆ—å
    churn_pd.rename(columns={'Churn_Yes': 'flag'}, inplace=True)
    print(f'åˆ—å: {churn_pd.columns}')

    # 5. æŸ¥çœ‹æ ‡ç­¾çš„åˆ†å¸ƒæƒ…å†µ 0.26ç”¨æˆ·æµå¤±
    value_counts = churn_pd.flag.value_counts()
    print(value_counts)


# 2. å®šä¹‰å‡½æ•°, è¡¨ç¤º: ç‰¹å¾ç­›é€‰
def dm02_ç‰¹å¾ç­›é€‰():
    # 1. è¯»å–æ•°æ®
    churn_pd = pd.read_csv('data/churn.csv')
    # 2. å¤„ç†ç±»åˆ«å‹çš„æ•°æ®, ç±»åˆ«å‹æ•°æ®åš one-hotç¼–ç (çƒ­ç¼–ç ).
    churn_pd = pd.get_dummies(churn_pd)
    # 3. å»é™¤åˆ— Churn_No, gender_Male
    churn_pd.drop(['Churn_No', 'gender_Male'], axis=1, inplace=True)
    # 4. åˆ—æ ‡ç­¾é‡å‘½å
    churn_pd.rename(columns={'Churn_Yes': 'flag'}, inplace=True)
    # 5. æŸ¥çœ‹æ ‡ç­¾çš„åˆ†å¸ƒæƒ…å†µ
    value_counts = churn_pd.flag.value_counts()
    print(value_counts)
    # 6. æŸ¥çœ‹Contract_Month æ˜¯å¦é¢„ç­¾çº¦æµå¤±æƒ…å†µ
    sns.countplot(data=churn_pd, x='Contract_Month', hue='flag')
    plt.show()


# 3. å®šä¹‰å‡½æ•°, è¡¨ç¤º: æ¨¡å‹è®­ç»ƒ å’Œ è¯„æµ‹
def dm03_æ¨¡å‹è®­ç»ƒå’Œè¯„æµ‹():
    # 1. è¯»å–æ•°æ®
    churn_pd = pd.read_csv('data/churn.csv')

    # 2. æ•°æ®é¢„å¤„ç†
    # 2.1 å¤„ç†ç±»åˆ«å‹çš„æ•°æ®, ç±»åˆ«å‹æ•°æ®åš one-hotç¼–ç (çƒ­ç¼–ç ).
    churn_pd = pd.get_dummies(churn_pd)
    # 2.2 å»é™¤åˆ— Churn_No, gender_Male
    churn_pd.drop(['Churn_No', 'gender_Male'], axis=1, inplace=True)
    # 2.3 åˆ—æ ‡ç­¾é‡å‘½å
    churn_pd.rename(columns={'Churn_Yes': 'flag'}, inplace=True)

    # 3. ç‰¹å¾å¤„ç†.
    # 3.1 æå–ç‰¹å¾å’Œæ ‡ç­¾
    x = churn_pd[['Contract_Month', 'internet_other', 'PaymentElectronic']]
    y = churn_pd['flag']
    # 3.2 è®­ç»ƒé›†å’Œæµ‹è¯•é›†çš„åˆ†å‰²
    x_train, x_test, y_train, y_test = train_test_split(x, y, test_size=0.3, random_state=21)

    # 4. æ¨¡å‹è®­ç»ƒ.
    estimator = LogisticRegression()
    estimator.fit(x_train, y_train)

    # 5. æ¨¡å‹é¢„æµ‹
    y_predict = estimator.predict(x_test)
    print(f'é¢„æµ‹ç»“æœ: {y_predict}')

    # 6. æ¨¡å‹è¯„ä¼°
    print(f'å‡†ç¡®ç‡: {accuracy_score(y_test, y_predict)}')
    print(f'å‡†ç¡®ç‡: {estimator.score(x_test, y_test)}')

    # è®¡ç®—AUCå€¼.
    print(f'AUCå€¼: {roc_auc_score(y_test, y_predict)}')



if __name__ == '__main__':
    # dm01_æ•°æ®åŸºæœ¬å¤„ç†()
    # dm02_ç‰¹å¾ç­›é€‰()
    dm03_æ¨¡å‹è®­ç»ƒå’Œè¯„æµ‹()

```







## ä½œä¸š

1. ä½¿ç”¨æ€ç»´å¯¼å›¾æ€»ç»“é€»è¾‘å›å½’çš„å†…å®¹



2. ç†è§£åˆ†ç±»è¯„ä¼°æ–¹æ³•å¹¶è¿›è¡Œè¯¦ç»†çš„æè¿°



3.åŠ¨æ‰‹å®ç°ç™Œç—‡åˆ†ç±»å’Œç”µä¿¡ç”¨æˆ·æµå¤±æ¡ˆä¾‹(æ•°æ®å¤„ç†ï¼Œç‰¹å¾å·¥ç¨‹ï¼ŒCVã€‚ã€‚ã€‚ã€‚)